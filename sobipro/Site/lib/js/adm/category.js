/**
 * @package SobiPro Library
 *
 * @author
 * Name: Sigrid Suski & Radek Suski, Sigsiu.NET GmbH
 * Url: https://www.Sigsiu.NET
 *
 * @copyright Copyright (C) 2006â€“2024 Sigsiu.NET GmbH (https://www.sigsiu.net). All rights reserved.
 * @license GNU/LGPL Version 3
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License version 3
 * as published by the Free Software Foundation, and under the additional terms according to section 7 of GPL v3.
 * See https://www.gnu.org/licenses/lgpl.html and https://www.sigsiu.net/licenses.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * @created 16 October 2012 by Radek Suski
 * @modified 04 March 2024 by Sigrid Suski
 */
function SPSelectIcon(e,o){SobiPro.jQuery("#SP_categoryIconHolder").val(e),SobiPro.jQuery('[name^="category.icon"]').val(o),SobiPro.jQuery("#SP_categoryIconHolder").val()&&SobiPro.jQuery("#spctrl-icon-btn").html('<img src="'+SobiPro.jQuery("#SP_categoryIconHolder").val()+'" class="sp-category-image" alt=""/>'),modalWindow.hide()}SobiCore.Ready((function(){if([].slice.call(document.querySelectorAll(".spctrl-category-btn")).map((e=>{e.addEventListener("click",(e=>{let o=e.currentTarget.getAttribute("rel");document.getElementById("spctrl-category-chooser").innerHTML='<iframe id="spctrl-frame" class="dk-frame" src="'+o+'"> </iframe>',new bootstrap.Modal(document.getElementById("spctrl-category-modal")).show()}))})),document.getElementById("spctrl-category-save").addEventListener("click",(e=>{if(!document.getElementById("SP_selectedCid").value)return;let o=document.getElementById("SP_selectedCatPath").value;o&&(document.getElementById("selectedCatPath").innerHTML=o),document.querySelector('[name^="category.parent"]').value=document.getElementById("SP_selectedCid").value,document.getElementById("categoryParentName").innerHTML=document.getElementById("SP_selectedCatName").value})),SobiPro.jQuery("#SP_categoryIconHolder").val()&&SobiPro.jQuery("#spctrl-icon-btn").html('<img src="'+SobiPro.jQuery("#SP_categoryIconHolder").val()+'" class="sp-category-image" alt=""/>'),SobiPro.jQuery('[name^="category.icon"]').val()&&-1!=SobiPro.jQuery('[name^="category.icon"]').val().indexOf("font-")){var e=JSON.parse(SobiPro.jQuery('[name^="category.icon"]').val().replace(/\\'/g,'"')),o=null!=e.content?e.content:"";SobiPro.jQuery("#spctrl-icon-btn").html("<"+e.element+' class="sp-icon-element '+e.class+'">'+o+"</"+e.element+">")}SobiPro.jQuery("#category-params-icon-font").val()&&-1!=SobiPro.jQuery("#category-params-icon-font").val().indexOf("font-")&&SobiPro.jQuery(".ctrl-add-font-class").removeClass("hidden"),SobiPro.jQuery.ajax({url:"index.php",type:"post",dataType:"json",data:{option:"com_sobipro",task:"category.iconFonts",sid:SobiProSection,selected:SobiPro.jQuery("#category-params-icon-font").children("option:selected").val(),format:"raw",tmpl:"component",method:"xhr"}}).done((function(e){SobiPro.jQuery("#category-params-icon-font option").each((function(o,t){let r=!1,n=SobiPro.jQuery(this).val();0!=n&&(SobiPro.jQuery.each(e,(function(e,o){-1!=n.indexOf(o)&&(r=!0)})),r||SobiPro.jQuery(this).attr("disabled","disabled"))}))})),SobiPro.jQuery("#category-params-icon-font").change((function(){SobiPro.jQuery(this).val()&&-1!=SobiPro.jQuery(this).val().indexOf("font-")?SobiPro.jQuery(".ctrl-add-font-class").removeClass("hidden"):SobiPro.jQuery(".ctrl-add-font-class").addClass("hidden")})),SobiPro.jQuery("#spctrl-icon-btn").click((function(){let e=SobiPro.jQuery("#category-params-icon-font").val();if(e)if(-1!=e.indexOf("font-")){SobiPro.jQuery("#spctrl-icon-chooser").html("");let o={option:"com_sobipro",task:"category.icon",sid:SobiProSection,format:"raw",tmpl:"component",method:"xhr",font:e};SobiPro.jQuery.ajax({url:"index.php",type:"post",dataType:"json",data:o}).done((function(o){if(o.length){var t,r=1;try{r=SobiPro.jQuery("#category-params-icon-font option:selected").text().match(/\((.*?)\)/),r=parseInt(r[1])}catch(e){r=1}SobiPro.jQuery.each(o,(function(o,r){var n=null!=r.content?r.content:"";t=r.element,r.font=e,SobiPro.jQuery("#spctrl-icon-chooser").append('<div class="spctrl-icon-element-container"><'+r.element+' class="sp-icon-element '+r.class+'" title="'+r.class+'" data-setting="'+JSON.stringify(r).replace(/"/g,"'")+'" data-font="'+r.font+'">'+n+"</"+r.element+"></div>")})),SobiPro.jQuery("#spctrl-icon-chooser").find(t).click((function(){SobiPro.jQuery("#spctrl-icon-btn").html(""),SobiPro.jQuery("#spctrl-icon-btn").append(SobiPro.jQuery(this).clone()),SobiPro.jQuery('[name^="category.icon"]').val(SobiPro.jQuery(this).data("setting")),SobiPro.jQuery(".spctrl-icon-element-container").removeClass("active").attr("data-spctrl-state",""),SobiPro.jQuery(this).parent().addClass("active").attr("data-spctrl-state","")})),new bootstrap.Modal(document.getElementById("spctrl-icon")).show()}}))}else if(e){let e=SobiPro.jQuery(this).attr("rel");SobiPro.jQuery("#spctrl-icon-chooser").html('<iframe id="spctrl-frame" class="dk-frame" src="'+e+'"> </iframe>'),new bootstrap.Modal(document.getElementById("spctrl-icon")).show()}}))}));