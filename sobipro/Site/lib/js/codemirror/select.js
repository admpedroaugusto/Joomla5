var select={};!function(){function e(e,t){for(;e&&e.parentNode!=t;)e=e.parentNode;return e}function t(t,n){for(;!t.previousSibling&&t.parentNode!=n;)t=t.parentNode;return e(t.previousSibling,n)}select.ie_selection=document.selection&&document.selection.createRangeCollection;var n="    ";select.scrollToNode=function(e){if(e){for(var t=e.ownerDocument,n=t.body,o=t.defaultView||t.parentWindow,r=t.documentElement,s=!e.nextSibling||!e.nextSibling.nextSibling||!e.nextSibling.nextSibling.nextSibling,i=0;e&&!e.offsetTop;)i++,e=e.previousSibling;0==i&&(s=!1);for(var l=i*(e?e.offsetHeight:0),c=0,a=e;a&&a.offsetParent;)l+=a.offsetTop,isBR(a)||(c+=a.offsetLeft),a=a.offsetParent;var f=n.scrollLeft||r.scrollLeft||0,d=n.scrollTop||r.scrollTop||0,u=c-f,v=l-d,m=!1;(u<0||u>(o.innerWidth||r.clientWidth||0))&&(f=c,m=!0),(v<0||s||v>(o.innerHeight||r.clientHeight||0)-50)&&(d=s?1e6:l,m=!0),m&&o.scrollTo(f,d)}},select.scrollToCursor=function(e){select.scrollToNode(select.selectionTopNode(e,!0)||e.firstChild)};var o=null;if(select.snapshotChanged=function(){o&&(o.changed=!0)},select.snapshotReplaceNode=function(e,t,n,r){function s(s){e==s.node&&(o.changed=!0,n&&s.offset>n?s.offset-=n:(s.node=t,s.offset+=r||0))}o&&(s(o.start),s(o.end))},select.snapshotMove=function(e,t,n,r,s){function i(i){e!=i.node||s&&0!=i.offset||(o.changed=!0,i.node=t,i.offset=r?Math.max(0,i.offset+n):n)}o&&(i(o.start),i(o.end))},select.ie_selection){function r(e,t){var n=e.document.selection.createRange();function o(e){for(var t=null;!t&&e;)t=e.nextSibling,e=e.parentNode;return r(t)}function r(e){for(;e&&e.firstChild;)e=e.firstChild;return{node:e,offset:0}}n.collapse(t);var s=n.parentElement();if(!isAncestor(e.document.body,s))return null;if(!s.firstChild)return r(s);var i=n.duplicate();i.moveToElementText(s),i.collapse(!0);for(var l=s.firstChild;l;l=l.nextSibling){if(3==l.nodeType){var c=l.nodeValue.length;i.move("character",c)}else i.moveToElementText(l),i.collapse(!1);var a=n.compareEndPoints("StartToStart",i);if(0==a)return o(l);if(1!=a)return 3!=l.nodeType?r(l):(i.setEndPoint("StartToEnd",n),{node:l,offset:c-i.text.length})}return o(s)}function s(e,t){var n=e.document.selection;if(n){var o=n.createRange();o.pasteHTML(t),o.collapse(!1),o.select()}}select.markSelection=function(e){if(o=null,e.document.selection){var t=r(e,!0),n=r(e,!1);t&&n&&(o={start:t,end:n,window:e,changed:!1})}},select.selectMarked=function(){if(o&&o.changed){var e=o.window.document,t=r(o.start),n=r(o.end);t.setEndPoint("StartToEnd",n),t.select()}function r(t){var n=e.body.createTextRange(),r=t.node;if(r)if(3==r.nodeType){n.moveToElementText(r.parentNode);for(var s=t.offset;r.previousSibling;)s+=((r=r.previousSibling).innerText||"").length;n.move("character",s)}else n.moveToElementText(r),n.collapse(!0);else n.moveToElementText(o.window.document.body),n.collapse(!1);return n}},select.selectionTopNode=function(t,n){var o=t.ownerDocument.selection;if(!o)return!1;var r=o.createRange(),s=r.duplicate();r.collapse(n);var i=r.parentElement();if(i&&isAncestor(t,i)&&(s.moveToElementText(i),1==r.compareEndPoints("StartToStart",s)))return e(i,t);function l(e,t){if(3==t.nodeType){for(var n=0,o=t.previousSibling;o&&3==o.nodeType;)n+=o.nodeValue.length,o=o.previousSibling;if(o){try{e.moveToElementText(o)}catch(e){return!1}e.collapse(!1)}else e.moveToElementText(t.parentNode);n&&e.move("character",n)}else try{e.moveToElementText(t)}catch(e){return!1}return!0}n=0;for(var c=t.childNodes.length-1;n<c;){var a=Math.ceil((c+n)/2),f=t.childNodes[a];if(!f)return!1;if(!l(s,f))return!1;1==r.compareEndPoints("StartToStart",s)?n=a:c=a-1}return t.childNodes[n]||null},select.focusAfterNode=function(e,t){var n=t.ownerDocument.body.createTextRange();n.moveToElementText(e||t),n.collapse(!e),n.select()},select.somethingSelected=function(e){var t=e.document.selection;return t&&""!=t.createRange().text},select.insertNewlineAtCursor=function(e){s(e,"<br>")},select.insertTabAtCursor=function(e){s(e,n)},select.cursorPos=function(e,t){var n=e.ownerDocument.selection;if(!n)return null;for(var o=select.selectionTopNode(e,t);o&&!isBR(o);)o=o.previousSibling;var r=n.createRange(),s=r.duplicate();if(r.collapse(t),o)s.moveToElementText(o),s.collapse(!1);else{try{s.moveToElementText(e)}catch(e){return null}s.collapse(!0)}return r.setEndPoint("StartToStart",s),{node:o,offset:r.text.length}},select.setCursorPos=function(e,t,n){function o(t){var n=e.ownerDocument.body.createTextRange();return t.node?(n.moveToElementText(t.node),n.collapse(!1)):(n.moveToElementText(e),n.collapse(!0)),n.move("character",t.offset),n}var r=o(t);n&&n!=t&&r.setEndPoint("EndToEnd",o(n)),r.select()},select.getBookmark=function(e){var t=select.cursorPos(e,!0),n=select.cursorPos(e,!1);if(t&&n)return{from:t,to:n}},select.setBookmark=function(e,t){t&&select.setCursorPos(e,t.from,t.to)}}else{function i(e,t){var n=t.getSelection();n.removeAllRanges(),n.addRange(e)}function l(e){var t=e.getSelection();return!(!t||0==t.rangeCount)&&t.getRangeAt(0)}function c(e,t){var n=l(e);n&&(n.deleteContents(),n.insertNode(t),webkitLastLineHack(e.document.body),(n=e.document.createRange()).selectNode(t),n.collapse(!1),i(n,e))}select.markSelection=function(e){var t=e.getSelection();if(!t||0==t.rangeCount)return o=null;var n=t.getRangeAt(0);function r(e){for(;3!=e.node.nodeType&&!isBR(e.node);){var t=e.node.childNodes[e.offset]||e.node.nextSibling;for(e.offset=0;!t&&e.node.parentNode;)e.node=e.node.parentNode,t=e.node.nextSibling;if(e.node=t,!t)break}}r((o={start:{node:n.startContainer,offset:n.startOffset},end:{node:n.endContainer,offset:n.endOffset},window:e,changed:!1}).start),r(o.end)},select.selectMarked=function(){var e=o;if(e&&(e.changed||webkit&&e.start.node==e.end.node&&0==e.start.offset&&0==e.end.offset)){var t=e.window,n=t.document.createRange();r(e.end,"End"),r(e.start,"Start"),i(n,t)}function r(e,o){e.node?0==e.offset?n["set"+o+"Before"](e.node):n["set"+o](e.node,e.offset):n.setStartAfter(t.document.body.lastChild||t.document.body)}},select.selectionTopNode=function(n,o){var r=l(n.ownerDocument.defaultView);if(!r)return!1;var s=o?r.startContainer:r.endContainer,i=o?r.startOffset:r.endOffset;return window.opera&&!o&&r.endContainer==n&&r.endOffset==r.startOffset+1&&n.childNodes[r.startOffset]&&isBR(n.childNodes[r.startOffset])&&i--,3==s.nodeType?i>0?e(s,n):t(s,n):"HTML"==s.nodeName.toUpperCase()?1==i?null:n.lastChild:s==n?0==i?null:s.childNodes[i-1]:i==s.childNodes.length?e(s,n):0==i?t(s,n):e(s.childNodes[i-1],n)},select.focusAfterNode=function(e,t){var n=t.ownerDocument.defaultView,o=n.document.createRange();o.setStartBefore(t.firstChild||t),e&&!e.firstChild?o.setEndAfter(e):e?o.setEnd(e,e.childNodes.length):o.setEndBefore(t.firstChild||t),o.collapse(!1),i(o,n)},select.somethingSelected=function(e){var t=l(e);return t&&!t.collapsed},select.insertNewlineAtCursor=function(e){c(e,e.document.createElement("BR"))},select.insertTabAtCursor=function(e){c(e,e.document.createTextNode(n))},select.cursorPos=function(e,t){var n=l(window);if(n){for(var o=select.selectionTopNode(e,t);o&&!isBR(o);)o=o.previousSibling;return(n=n.cloneRange()).collapse(t),o?n.setStartAfter(o):n.setStartBefore(e),{node:o,offset:n.toString().length}}},select.setCursorPos=function(e,t,n){var o=e.ownerDocument.defaultView,r=o.document.createRange();function s(t,n,o){if(0==n&&t&&!t.nextSibling)return r["set"+o+"After"](t),!0;if(t=t?t.nextSibling:e.firstChild){if(0==n)return r["set"+o+"Before"](t),!0;for(var s=[];;){for(;t&&!s.length;)c(t),t=t.nextSibling;var i=s.shift();if(!i)return!1;var l=i.nodeValue.length;if(l>=n)return r["set"+o](i,n),!0;n-=l}}function c(e){3==e.nodeType?s.push(e):forEach(e.childNodes,c)}}s((n=n||t).node,n.offset,"End")&&s(t.node,t.offset,"Start")&&i(r,o)}}}();