<?xml version="1.0" encoding="utf-8"?><!--
 @package SobiPro multi-directory component with content construction support

 @author
 Name: Sigrid Suski & Radek Suski, Sigsiu.NET GmbH
 Email: sobi[at]sigsiu.net
 Url: https://www.Sigsiu.NET

 @copyright Copyright (C) 2006 - 2023 Sigsiu.NET GmbH (https://www.sigsiu.net). All rights reserved.
 @license GNU/GPL Version 3
 This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License version 3
 as published by the Free Software Foundation, and under the additional terms according section 7 of GPL v3.
 See https://www.gnu.org/licenses/gpl.html and https://www.sigsiu.net/licenses.

 This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

 @modified 25 September 2023 by Sigrid Suski
-->

<definition>
	<header>
		<file type="script" filename="adm.tabs"/>
		<file type="script" filename="adm.revisions"/>
	</header>

	<toolbar title="{'entry.add':'ADD_NEW_ENTRY','entry.edit':'EDIT_EXISTING_ENTRY'}" class="entry edit">
		<buttons icon="globe" buttons="languages-list" label="TB.LANGUAGES"/>
		<button type="delete" task="entry.deleteHistory" label="TB.DELETEHISTORY" condition="history.length and acl.entry.delete" confirm="TB.JS_DELETE_HISTORY_WARN"
		        colour="delete"/>
		<button task="entry.apply" type="apply" condition="acl.entry.edit" colour="save">
			<button type="save" task="entry.save" colour="save"/>
			<button type="save" task="entry.saveWithRevision" label="TB.SAVE_WITH_REVISION" condition="history-log" icon="comment" colour="save"/>
			<button task="entry.saveAndNew" label="TB.SAVE_AND_NEW" icon="file-alt" colour="save"/>
			<button type="duplicate" task="entry.clone" colour="save"/>
		</button>
		<button type="exit" task="entry.cancel" colour="exit"/>
		<button type="help" target="_blank"/>
	</toolbar>

	<body disable-menu="true">
		<div class="row">
			<div class="col-lg-12 sp-main-area">
				<message id="spctrl-message"/>
				<tabs>
					<tab label="EN.BASE_DATA">
						<fieldset show="no" condition="status">
							<field type="output" class="is-invalid" value="status"/>
						</fieldset>
						<fieldset base="12" labelwidth="labelwidth">
							<loop subject="entry.fields"/>
						</fieldset>

						<legend class="text-muted small">
							<param icon="fas fa-star dk-sup" value="ENTRY_REQUIRED_MESSAGE" parse="true"/>
						</legend>
					</tab>

					<tab label="EN.ENTRY_GENERAL_DATA">
						<fieldset>
							<field type="output" value="entry.id" label="HEADER_ID" class="badge rounded-pill bg-secondary"/>
							<field type="text" name="entry.nid" value="entry.nid" label="CATN.CATEGORY_ALIAS" placeholder="EN.ENTRY_PLACEHOLDER_ALIAS" width="5"/>
							<field type="output" condition='voting' value="voting" label="VOTING_RESULT"/>
						</fieldset>
					</tab>

					<tab label="META_DATA">
						<fieldset>
							<field type="textarea" name="entry.metaDesc" value="entry.metaDesc" label="DESCRIPTION" editor="false" width="9" rows="2" style=""/>
							<field type="textarea" name="entry.metaKeys" value="entry.metaKeys" label="KEYS" editor="false" width="9" rows="2" style=""/>
							<field type="text" name="entry.metaAuthor" value="entry.metaAuthor" label="AUTHOR" width="4" maxlength="255"/>
							<field type="select" label="ROBOTS" name="entry.metaRobots" selected="entry.metaRobots" width="4">
								<values>
									<option value="" label="ROBOTS_NONE"/>
									<option value="index, follow" label="index, follow"/>
									<option value="index, nofollow" label="index, nofollow"/>
									<option value="noindex, follow" label="noindex, follow"/>
									<option value="noindex, nofollow" label="noindex, nofollow"/>
								</values>
							</field>
						</fieldset>
					</tab>

					<tab label="EN.ENTRY_PUBLISHING">
						<fieldset>
							<field type="toggle" name="entry.state" value="entry.state" label="PUBLISHED" prefix="yes_no" condition="acl.entry.publish"/>
							<field type="toggle" name="entry.approved" value="entry.approved" label="APPROVED" prefix="yes_no" condition="acl.entry.approve"/>
							<field type="datepicker" label="VALID_SINCE" name="entry.validSince" value="entry.validSince" width="4" dateFormat="cfg:publishing_format"
							       icon="unlock"/>
							<field type="datepicker" label="VALID_UNTIL" name="entry.validUntil" value="entry.validUntil" width="4" dateFormat="cfg:publishing_format" icon="lock"/>
						</fieldset>
						<fieldset label="CATN.EDIT_DATA">
							<field type="output" value="entry.version" label="VERSION" class="badge rounded-pill bg-secondary"/>
							<field type="datepicker" label="CREATED_AT" name="entry.createdTime" value="entry.createdTime" width="4" dateFormat="cfg:publishing_format"
							       icon="calendar"/>
							<field type="userselector" label="OWNER" name="entry.owner" value="entry.owner" width="4" format="%name (%id)"/>
							<field type="output" label="CREATED_BY_IP" name="entry.ownerIP" width="5">
								<value>
									<url type="external" host="https://apps.db.ripe.net/db-web-ui/query?" content="entry.ownerIP" target="_blank">
										<param name="searchtext" value="entry.ownerIP" parse="true"/>
									</url>
								</value>
							</field>
							<field type="dategetter" label="MODIFIED_AT" name="entry.updatedTime" value="entry.updatedTime" dateFormat="cfg:publishing_format" width="5"/>
							<field type="userGetter" label="MODIFIED_BY" name="entry.updater" value="entry.updater" width="5"
							       format="%name (%id)"/>
							<field type="output" label="MODIFIED_BY_IP" name="entry.updaterIP" width="5">
								<value>
									<url type="external" host="https://apps.db.ripe.net/db-web-ui/query?" content="entry.updaterIP" target="_blank">
										<param name="searchtext" value="entry.updaterIP" parse="true"/>
									</url>
								</value>
							</field>
						</fieldset>
						<fieldset label="CLICKCOUNTER" condition="acl.entry.edit">
							<field type="button" label="CAT.RESET_COUNT" value="entry.counter" name="counter" class="btn btn-secondary spctrl-counter-reset" rel="entry"
							       aria-label="ACCESSIBILITY.COUNTER_RESET" aria-after="ACCESSIBILITY.COUNTER"/>
						</fieldset>
					</tab>

					<tab label="EN.ENTRY_HISTORY" condition="history.length">
						<div class="table-responsive">
							<table class="table-hover table-sm">
								<head>
									<cell type="text" label="HEAD_HISTORY_DATE" class="dk-cell text-center"/>
									<cell type="text" label="HEAD_HISTORY_CHANGED_BY"/>
									<cell type="text" label="HEAD_HISTORY_NOTE" class="dk-cell text-center"/>
									<cell type="text" label="HEAD_HISTORY_SITE" class="dk-cell text-center"/>
									<cell type="text" label="HEAD_HISTORY_LOAD" class="dk-cell text-center"/>
									<cell type="text" label="HEAD_HISTORY_DELETE" class="dk-cell text-center" condition="acl.entry.delete"/>
								</head>
								<loop subject="history">
									<cell class="dk-cell text-center">
										<date value="changedAt"/>
									</cell>
									<cell type="link" value="userName" condition="uid" sef="false" live="true" aria-before="ACCESSIBILITY.USER_CHANGED">
										<url type="intern">
											<param name="option" value="com_users"/>
											<param name="task" value="user.edit"/>
											<param name="id" value="uid" parse="true"/>
										</url>
									</cell>
									<cell type="text" value="" invert-condition="uid"/>
									<cell class="dk-cell text-center">
										<cell condition="status" class="sp-reason">
											<popover>
												<attribute name="content" value="reason" parse="true"/>
												<attribute name="href" value="description-url" parse="true"/>
												<attribute name="title" value="HISTORY_NOTE" parse="false"/>
												<attribute name="class" value="wide" parse="false"/>
												<attribute name="trigger" value="focus" parse="false"/>
												<attribute name="placement" value="top" parse="false"/>
												<attribute name="icon" value="info text-info" parse="false"/>
											</popover>
										</cell>
									</cell>
									<cell type="text" value="site" class="dk-cell text-center"/>
									<cell type="link" label="HISTORY_LOAD" sef="false" live="true" class="dk-cell text-center w-15">
										<url type="intern" class="btn btn-secondary btn-sm dk-btn-icon" role="button" icon="history">
											<param name="task" value="entry.edit"/>
											<param name="sid" value="id" parse="true" subject="skip"/>
											<param name="pid" value="sid" parse="true" subject="skip"/>
											<param name="revision" value="revision" parse="true"/>
											<param name="sp-language" value="language" parse="true"/>
										</url>
									</cell>
									<cell type="link" label="HISTORY_DELETE" sef="false" live="true" class="dk-cell text-center w-15" condition="/acl.entry.delete">
										<url type="intern" class="btn btn-danger btn-sm dk-btn-icon" role="button" icon="trash">
											<param name="task" value="entry.edit"/>
											<param name="sid" value="id" parse="true" subject="skip"/>
											<param name="pid" value="sid" parse="true" subject="skip"/>
											<param name="delete" value="revision" parse="true"/>
											<param name="sp-language" value="language" parse="true"/>
										</url>
									</cell>
								</loop>
							</table>
						</div>
					</tab>
				</tabs>
			</div>
		</div>

		<div condition="revision-change">
			<div class="sp-history modal fade" id="spctrl-revisions-window" tabindex="-1" aria-labelledby="sparia-title">
				<div class="modal-dialog modal-lg modal-fullscreen-sm-down">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="modal-title" id="sparia-title">
								<text value="HISTORY_REVISION_COMPARE"/>
							</h3>
							<button class="btn-close" data-bs-dismiss="modal" aria-label="ACCESSIBILITY.CLOSE"/>
						</div>
						<div class="modal-body">
							<div class="sp-history-table">
								<div class="row spctrl-diff">
									<div class="diff" id="revision-diff" style="overflow:scroll"/>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<a href="#" class="btn btn-secondary" data-bs-dismiss="modal" role="button">
								<text value="CLOSE"/>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>

	<config>
		<action value="index.php"/>
		<hidden>
			<field name="option" default="com_sobipro"/>
			<field name="task" default=""/>
			<field name="method" default="xhr"/>
			<field name="sp-language" default=""/>
			<field name="sid" value="entry.sid"/>
			<field name="history-behaviour" value="history-behaviour" condition="history-on"/>
			<field name="history-note" value="" condition="history-on"/>
		</hidden>
	</config>
</definition>